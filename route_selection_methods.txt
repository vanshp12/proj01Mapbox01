
    // ========== ROUTE SELECTION METHODS ==========

    private void selectRoute(int index) {
        if (index == selectedRouteIndex || index >= allRoutes.size()) {
            return; // Already selected or invalid index
        }
        
        selectedRouteIndex = index;
        
        // Update map display
        updateMapRouteDisplay();
        
        // Update current route data
        RouteData selectedRoute = allRoutes.get(index);
        currentRoutePoints = selectedRoute.points;
        currentRouteDistanceKm = selectedRoute.distanceKm;
        currentRouteDurationMinutes = (int) Math.round(selectedRoute.durationMinutes);
        
        if (!selectedRoute.points.isEmpty()) {
            routeStart = selectedRoute.points.get(0);
            routeEnd = selectedRoute.points.get(selectedRoute.points.size() - 1);
        }
        
        // Haptic feedback
        performHapticFeedback(binding.bottomSheet);
        
        // Toast notification
        Toast.makeText(this, "Route " + (index + 1) + " selected", Toast.LENGTH_SHORT).show();
    }

    private void updateMapRouteDisplay() {
        if (mapboxMap == null || mapboxMap.getStyle() == null) return;
        
        com.mapbox.maps.Style style = mapboxMap.getStyle();
        
        // Update each route's styling
        for (int i = 0; i < allRoutes.size(); i++) {
            RouteData route = allRoutes.get(i);
            
            try {
                // Get the layer
                com.mapbox.maps.extension.style.layers.Layer layer = 
                    com.mapbox.maps.extension.style.layers.LayerUtils.getLayer(style, route.layerId);
                
                if (layer instanceof com.mapbox.maps.extension.style.layers.generated.LineLayer) {
                    com.mapbox.maps.extension.style.layers.generated.LineLayer lineLayer = 
                        (com.mapbox.maps.extension.style.layers.generated.LineLayer) layer;
                    
                    if (i == selectedRouteIndex) {
                        // Selected route: Blue, thick
                        lineLayer.lineColor("#4285F4");
                        lineLayer.lineWidth(10.0);
                        lineLayer.lineOpacity(1.0);
                    } else {
                        // Non-selected route: Light gray, thin
                        lineLayer.lineColor("#BDBDBD");
                        lineLayer.lineWidth(5.0);
                        lineLayer.lineOpacity(0.6);
                    }
                }
            } catch (Exception e) {
                Log.e(TAG, "Error updating route layer: " + route.layerId, e);
            }
        }
    }
}
